<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Conex√£o Familiar</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-main) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 20px 60px rgba(99, 102, 241, 0.3);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--bg-card-hover);
            z-index: 0;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-card-hover);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .step.active .step-circle {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.5);
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background: var(--success);
        }

        .step-label {
            font-size: 0.85rem;
            text-align: center;
            color: var(--text-muted);
        }

        .step.active .step-label {
            color: var(--text-primary);
            font-weight: 600;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.6);
        }

        .btn-secondary {
            background: var(--bg-card-hover);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-card);
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            padding: 20px;
            background: var(--bg-card-hover);
            border-radius: 12px;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-container:hover {
            background: var(--bg-card);
        }

        .checkbox-container input[type="checkbox"] {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            cursor: pointer;
        }

        .video-container {
            background: var(--bg-main);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .video-placeholder {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.2));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .practice-field {
            margin: 20px 0;
        }

        .practice-field textarea {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid var(--bg-card-hover);
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: border-color 0.3s ease;
        }

        .practice-field textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .feedback {
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .feedback.success {
            background: rgba(16, 185, 129, 0.2);
            border-left: 4px solid var(--success);
            display: block;
        }

        .feedback.warning {
            background: rgba(245, 158, 11, 0.2);
            border-left: 4px solid var(--warning);
            display: block;
        }

        form {
            display: grid;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border-radius: 8px;
            border: 2px solid var(--bg-card-hover);
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .slider-container {
            padding: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--bg-card-hover);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(99, 102, 241, 0.5);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            cursor: pointer;
            border: none;
        }

        .slider-value {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            margin-top: 10px;
            color: var(--primary);
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .admin-panel {
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border-left: 4px solid var(--primary);
        }

        .stat-card.danger {
            border-left-color: var(--danger);
        }

        .stat-card.warning {
            border-left-color: var(--warning);
        }

        .stat-card.success {
            border-left-color: var(--success);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .reports-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .reports-table th,
        .reports-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--bg-card-hover);
        }

        .reports-table th {
            background: var(--bg-card-hover);
            font-weight: 600;
            color: var(--text-secondary);
        }

        .reports-table tr:hover {
            background: var(--bg-card-hover);
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.high {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.medium {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.low {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-bar select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid var(--bg-card-hover);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 1rem;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            .step-indicator {
                flex-wrap: wrap;
            }

            .step {
                margin-bottom: 20px;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .reports-table {
                font-size: 0.85rem;
            }

            .reports-table th,
            .reports-table td {
                padding: 10px 5px;
            }
        }

        .alert {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--danger);
        }

        .alert h3 {
            margin-bottom: 10px;
            color: var(--danger);
        }

        .info-box {
            background: rgba(99, 102, 241, 0.1);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .info-box h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ù Guia Conex√£o Familiar</h1>
            <p>Capacitando pais e respons√°veis no combate ao bullying escolar</p>
        </header>

        <!-- Onboarding Section -->
        <div id="onboarding-section" class="content-section active">
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Momento Certo</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Porto Seguro</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Pergunta M√°gica</div>
                </div>
                <div class="step" data-step="4">
                    <div class="step-circle">4</div>
                    <div class="step-label">Processamento</div>
                </div>
            </div>

            <!-- Step 1 -->
            <div class="card step-content" data-step="1">
                <h2>üïê O Momento Certo</h2>
                <p style="margin: 20px 0; font-size: 1.1rem;">Para criar um ambiente prop√≠cio ao di√°logo, escolha um momento especial com seu filho(a).</p>
                
                <div class="info-box">
                    <h3>Por que isso √© importante?</h3>
                    <p>Conversas sobre temas sens√≠veis precisam acontecer em momentos de calma e conex√£o. Evite per√≠odos de tens√£o, pressa ou quando h√° outras pessoas presentes.</p>
                </div>

                <h3 style="margin: 30px 0 15px 0;">‚úÖ Exemplos de bons momentos:</h3>
                <ul style="margin-left: 20px; color: var(--text-secondary);">
                    <li>Durante um passeio de carro</li>
                    <li>Cozinhando juntos</li>
                    <li>Antes de dormir, no quarto</li>
                    <li>Durante uma caminhada no parque</li>
                    <li>Enquanto praticam um hobby juntos</li>
                </ul>

                <div class="checkbox-container" id="step1-checkbox">
                    <input type="checkbox" id="momento-check">
                    <label for="momento-check">Sim, escolhi um momento sem pressa e em particular para conversar com meu filho(a).</label>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" id="step1-next" disabled>Avan√ßar</button>
                </div>
            </div>

            <!-- Step 2 -->
            <div class="card step-content" data-step="2" style="display: none;">
                <h2>üõ°Ô∏è Criando o Porto Seguro</h2>
                <p style="margin: 20px 0; font-size: 1.1rem;">A forma como voc√™ escuta √© t√£o importante quanto o que voc√™ diz.</p>

                <div class="info-box">
                    <h3>Princ√≠pios da Escuta Ativa</h3>
                    <p><strong>Valide os sentimentos:</strong> "Eu entendo que isso deve ser dif√≠cil para voc√™."</p>
                    <p><strong>Evite minimizar:</strong> Nunca diga "N√£o √© nada demais" ou "Voc√™ est√° exagerando."</p>
                    <p><strong>Mantenha contato visual:</strong> Demonstre presen√ßa total.</p>
                    <p><strong>N√£o interrompa:</strong> Deixe seu filho(a) terminar de falar.</p>
                </div>

                <div class="video-container">
                    <div class="video-placeholder">üé¨</div>
                    <p style="color: var(--text-muted);">Exemplo de postura e escuta atenta</p>
                    <p style="margin-top: 10px;">Uma conversa acolhedora cria confian√ßa e abertura emocional.</p>
                </div>

                <div class="alert">
                    <h3>‚ö†Ô∏è Evite estas rea√ß√µes:</h3>
                    <ul style="margin-left: 20px;">
                        <li>"Voc√™ est√° inventando isso"</li>
                        <li>"Na minha √©poca era pior"</li>
                        <li>"Voc√™ precisa ser mais forte"</li>
                        <li>"Vou l√° na escola resolver isso agora!"</li>
                    </ul>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Voltar</button>
                    <button class="btn btn-primary" onclick="nextStep()">Entendi, Avan√ßar</button>
                </div>
            </div>

            <!-- Step 3 -->
            <div class="card step-content" data-step="3" style="display: none;">
                <h2>‚ú® A Pergunta M√°gica</h2>
                <p style="margin: 20px 0; font-size: 1.1rem;">Perguntas abertas e indiretas s√£o mais eficazes do que quest√µes diretas.</p>

                <div class="info-box">
                    <h3>Por que perguntas abertas funcionam melhor?</h3>
                    <p>Elas permitem que seu filho(a) compartilhe no pr√≥prio ritmo, sem sentir-se pressionado ou interrogado.</p>
                </div>

                <h3 style="margin: 30px 0 15px 0;">‚ùå Evite perguntas diretas:</h3>
                <ul style="margin-left: 20px; color: var(--danger);">
                    <li>"Voc√™ est√° sofrendo bullying?"</li>
                    <li>"Algu√©m est√° te maltratando?"</li>
                    <li>"Por que voc√™ n√£o tem amigos?"</li>
                </ul>

                <h3 style="margin: 30px 0 15px 0;">‚úÖ Prefira perguntas abertas:</h3>
                <ul style="margin-left: 20px; color: var(--success);">
                    <li>"O que tem sido mais chato na escola ultimamente?"</li>
                    <li>"Como voc√™ tem se sentido com seus colegas?"</li>
                    <li>"Tem algo que voc√™ gostaria de mudar na escola?"</li>
                    <li>"Com quem voc√™ mais gosta de conversar no recreio?"</li>
                </ul>

                <div class="practice-field">
                    <h3 style="margin-bottom: 15px;">üéØ Campo de Pr√°tica</h3>
                    <p style="margin-bottom: 10px; color: var(--text-secondary);">Digite a pergunta que voc√™ pretende fazer ao seu filho(a):</p>
                    <textarea id="practice-question" placeholder="Ex: Como tem sido seu dia na escola?"></textarea>
                    <div id="question-feedback" class="feedback"></div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Voltar</button>
                    <button class="btn btn-primary" onclick="analyzeQuestion()">Analisar Pergunta</button>
                    <button class="btn btn-primary" id="step3-next" style="display: none;" onclick="nextStep()">Avan√ßar</button>
                </div>
            </div>

            <!-- Step 4 -->
            <div class="card step-content" data-step="4" style="display: none;">
                <h2>üí≠ O Processamento</h2>
                <p style="margin: 20px 0; font-size: 1.1rem;">Quando seu filho(a) se abrir, este √© o momento mais delicado.</p>

                <div class="alert">
                    <h3>‚ö†Ô∏è Este √© o momento de ESCUTAR, n√£o de AGIR</h3>
                    <p>N√£o prometa resolver tudo imediatamente. N√£o v√° √† escola confrontar algu√©m sem um plano estruturado.</p>
                </div>

                <div class="info-box">
                    <h3>O que fazer quando seu filho(a) falar:</h3>
                    <ol style="margin-left: 20px; line-height: 2;">
                        <li><strong>Agrade√ßa a confian√ßa:</strong> "Muito obrigado(a) por compartilhar isso comigo."</li>
                        <li><strong>Valide os sentimentos:</strong> "Eu entendo que voc√™ est√° se sentindo assim."</li>
                        <li><strong>N√£o julgue:</strong> Nem seu filho(a), nem os colegas ainda.</li>
                        <li><strong>Busque ajuda conjunta:</strong> "Vamos juntos pensar na melhor forma de lidar com isso."</li>
                        <li><strong>Envolva a escola de forma estruturada:</strong> Use o formul√°rio de relato que forneceremos.</li>
                    </ol>
                </div>

                <h3 style="margin: 30px 0 15px 0;">‚úÖ Frases que ajudam:</h3>
                <ul style="margin-left: 20px; color: var(--success); line-height: 2;">
                    <li>"Voc√™ n√£o est√° sozinho(a) nisso."</li>
                    <li>"Foi muito corajoso voc√™ me contar."</li>
                    <li>"Vamos encontrar uma solu√ß√£o juntos."</li>
                    <li>"A escola tem pessoas preparadas para nos ajudar."</li>
                </ul>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Voltar</button>
                    <button class="btn btn-primary" onclick="completeOnboarding()">Concluir Guia e Preencher Relato</button>
                </div>
            </div>
        </div>

        <!-- Report Form Section -->
        <div id="report-section" class="content-section">
            <div class="card">
                <h2>üìã Formul√°rio de Relato</h2>
                <p style="margin: 20px 0;">Preencha as informa√ß√µes abaixo com base na conversa que voc√™ teve com seu filho(a).</p>

                <form id="report-form">
                    <div class="form-group">
                        <label for="parent-name">Nome do Respons√°vel *</label>
                        <input type="text" id="parent-name" required>
                    </div>

                    <div class="form-group">
                        <label for="parent-phone">Telefone *</label>
                        <input type="tel" id="parent-phone" required>
                    </div>

                    <div class="form-group">
                        <label for="parent-email">E-mail *</label>
                        <input type="email" id="parent-email" required>
                    </div>

                    <div class="form-group">
                        <label for="student-name">Nome do Aluno(a) *</label>
                        <input type="text" id="student-name" required>
                    </div>

                    <div class="form-group">
                        <label for="student-grade">Turma/S√©rie *</label>
                        <input type="text" id="student-grade" placeholder="Ex: 7¬∫ Ano B" required>
                    </div>

                    <div class="form-group">
                        <label for="contact-reason">Motivo Principal do Contato *</label>
                        <select id="contact-reason" required>
                            <option value="">Selecione...</option>
                            <option value="victim">Suspeita de V√≠tima</option>
                            <option value="aggressor">Suspeita de Agressor</option>
                            <option value="witness">Presenciou Algo</option>
                            <option value="other">Outro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="incident-location">Onde ocorreu? *</label>
                        <select id="incident-location" required>
                            <option value="">Selecione...</option>
                            <option value="classroom">Sala de aula</option>
                            <option value="playground">P√°tio/Recreio</option>
                            <option value="bathroom">Banheiro</option>
                            <option value="corridor">Corredor</option>
                            <option value="entrance">Entrada/Sa√≠da</option>
                            <option value="online">Online/Redes sociais</option>
                            <option value="other">Outro local</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="incident-when">Quando ocorreu? *</label>
                        <input type="text" id="incident-when" placeholder="Ex: Esta semana, m√™s passado..." required>
                    </div>

                    <div class="form-group">
                        <label for="incident-details">Detalhes do Relato *</label>
                        <textarea id="incident-details" rows="5" placeholder="Descreva o que seu filho(a) relatou..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="emotion-scale">Como seu filho(a) se sente? (1 = Tranquilo, 10 = Muito Angustiado) *</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="10" value="5" class="slider" id="emotion-scale">
                            <div class="slider-value" id="emotion-value">5</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="psychological-support">Disponibilidade para Apoio Psicol√≥gico *</label>
                        <select id="psychological-support" required>
                            <option value="">Selecione...</option>
                            <option value="yes">Sim, gostar√≠amos de apoio</option>
                            <option value="no">N√£o no momento</option>
                            <option value="maybe">Talvez, gostaria de mais informa√ß√µes</option>
                        </select>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">Enviar Relato</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Admin Panel Section -->
        <div id="admin-section" class="content-section">
            <div class="card">
                <h2>üìä Painel Administrativo - Radar Escolar</h2>
                <p style="margin: 20px 0;">Visualiza√ß√£o e gerenciamento de relatos recebidos.</p>

                <div class="stats-grid">
                    <div class="stat-card danger">
                        <div class="stat-value" id="high-risk-count">0</div>
                        <div class="stat-label">Casos de Alto Risco</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="medium-risk-count">0</div>
                        <div class="stat-label">Casos de M√©dio Risco</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="low-risk-count">0</div>
                        <div class="stat-label">Casos de Baixo Risco</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="completed-onboarding">0</div>
                        <div class="stat-label">Pais que Completaram o Guia</div>
                    </div>
                </div>

                <div class="filter-bar">
                    <select id="filter-grade">
                        <option value="all">Todas as Turmas</option>
                    </select>
                    <select id="filter-risk">
                        <option value="all">Todos os N√≠veis de Risco</option>
                        <option value="high">Alto Risco</option>
                        <option value="medium">M√©dio Risco</option>
                        <option value="low">Baixo Risco</option>
                    </select>
                    <select id="filter-status">
                        <option value="all">Todos os Status</option>
                        <option value="pending">Pendente</option>
                        <option value="in-progress">Em Acompanhamento</option>
                        <option value="closed">Fechado</option>
                    </select>
                </div>

                <div style="overflow-x: auto;">
                    <table class="reports-table">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Aluno(a)</th>
                                <th>Turma</th>
                                <th>Motivo</th>
                                <th>Risco</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="reports-tbody">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 40px; color: var(--text-muted);">
                                    Nenhum relato registrado ainda.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let reports = [];
        let completedOnboardings = 0;
        let currentStep = 1;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkUrlParams();
            setupEventListeners();
            loadSampleData();
        });

        function checkUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const view = urlParams.get('view');
            
            if (view === 'relato') {
                showSection('report');
            } else if (view === 'admin') {
                showSection('admin');
            } else {
                showSection('onboarding');
            }
        }

        function setupEventListeners() {
            // Step 1 checkbox
            document.getElementById('momento-check').addEventListener('change', function() {
                document.getElementById('step1-next').disabled = !this.checked;
            });

            document.getElementById('step1-next').addEventListener('click', nextStep);

            // Emotion scale slider
            const emotionSlider = document.getElementById('emotion-scale');
            const emotionValue = document.getElementById('emotion-value');
            
            emotionSlider.addEventListener('input', function() {
                emotionValue.textContent = this.value;
                emotionValue.style.color = getEmotionColor(parseInt(this.value));
            });

            // Report form
            document.getElementById('report-form').addEventListener('submit', handleReportSubmit);

            // Filter listeners
            document.getElementById('filter-grade').addEventListener('change', filterReports);
            document.getElementById('filter-risk').addEventListener('change', filterReports);
            document.getElementById('filter-status').addEventListener('change', filterReports);
        }

        function getEmotionColor(value) {
            if (value >= 8) return '#ef4444';
            if (value >= 5) return '#f59e0b';
            return '#10b981';
        }

        function nextStep() {
            if (currentStep < 4) {
                // Hide current step
                document.querySelector(`.step-content[data-step="${currentStep}"]`).style.display = 'none';
                
                // Update step indicator
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('completed');
                
                currentStep++;
                
                // Show next step
                document.querySelector(`.step-content[data-step="${currentStep}"]`).style.display = 'block';
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                // Hide current step
                document.querySelector(`.step-content[data-step="${currentStep}"]`).style.display = 'none';
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                
                currentStep--;
                
                // Show previous step
                document.querySelector(`.step-content[data-step="${currentStep}"]`).style.display = 'block';
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('completed');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function analyzeQuestion() {
            const question = document.getElementById('practice-question').value.trim();
            const feedback = document.getElementById('question-feedback');
            
            if (!question) {
                feedback.className = 'feedback warning';
                feedback.innerHTML = '<strong>‚ö†Ô∏è Aten√ß√£o:</strong> Por favor, digite uma pergunta para analisar.';
                return;
            }

            // Check for closed questions (yes/no answers)
            const closedQuestions = ['voc√™ est√°', 'voc√™ √©', 'voc√™ sofre', 'algu√©m te', 'tem algu√©m'];
            const isClosed = closedQuestions.some(phrase => question.toLowerCase().includes(phrase));
            
            // Check for open questions
            const openWords = ['como', 'o que', 'qual', 'quais', 'conte', 'descreva', 'me fale'];
            const isOpen = openWords.some(word => question.toLowerCase().includes(word));

            if (isClosed || question.endsWith('?') && (question.toLowerCase().includes('voc√™') || question.toLowerCase().includes('voce'))) {
                if (!isOpen) {
                    feedback.className = 'feedback warning';
                    feedback.innerHTML = '<strong>‚ö†Ô∏è Aten√ß√£o:</strong> Sua pergunta parece muito direta ou fechada. Tente reformular usando "Como...", "O que..." ou "Conte-me sobre...".';
                    document.getElementById('step3-next').style.display = 'none';
                    return;
                }
            }

            feedback.className = 'feedback success';
            feedback.innerHTML = '<strong>‚úÖ √ìtima pergunta!</strong> Esta √© uma pergunta aberta que permite que seu filho(a) compartilhe mais livremente.';
            document.getElementById('step3-next').style.display = 'inline-block';
        }

        function completeOnboarding() {
            completedOnboardings++;
            showSection('report');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showSection(section) {
            document.querySelectorAll('.content-section').forEach(s => {
                s.classList.remove('active');
            });

            if (section === 'onboarding') {
                document.getElementById('onboarding-section').classList.add('active');
            } else if (section === 'report') {
                document.getElementById('report-section').classList.add('active');
            } else if (section === 'admin') {
                document.getElementById('admin-section').classList.add('active');
                updateAdminStats();
                renderReports();
            }
        }

        function handleReportSubmit(e) {
            e.preventDefault();

            const emotionScale = parseInt(document.getElementById('emotion-scale').value);
            const contactReason = document.getElementById('contact-reason').value;

            const report = {
                id: Date.now(),
                date: new Date().toLocaleDateString('pt-BR'),
                parentName: document.getElementById('parent-name').value,
                parentPhone: document.getElementById('parent-phone').value,
                parentEmail: document.getElementById('parent-email').value,
                studentName: document.getElementById('student-name').value,
                studentGrade: document.getElementById('student-grade').value,
                contactReason: contactReason,
                incidentLocation: document.getElementById('incident-location').value,
                incidentWhen: document.getElementById('incident-when').value,
                incidentDetails: document.getElementById('incident-details').value,
                emotionScale: emotionScale,
                psychologicalSupport: document.getElementById('psychological-support').value,
                riskLevel: calculateRiskLevel(emotionScale, contactReason),
                status: 'pending'
            };

            reports.push(report);
            
            alert('‚úÖ Relato enviado com sucesso!\n\nA equipe escolar entrar√° em contato em breve.\n\nObrigado por confiar em n√≥s.');
            
            document.getElementById('report-form').reset();
            document.getElementById('emotion-value').textContent = '5';
            
            // Redirect to admin to see the report
            window.location.href = '?view=admin';
        }

        function calculateRiskLevel(emotionScale, contactReason) {
            if (emotionScale >= 8 && contactReason === 'victim') return 'high';
            if (emotionScale >= 8 || contactReason === 'victim') return 'medium';
            if (emotionScale >= 5) return 'medium';
            return 'low';
        }

        function updateAdminStats() {
            const highRisk = reports.filter(r => r.riskLevel === 'high').length;
            const mediumRisk = reports.filter(r => r.riskLevel === 'medium').length;
            const lowRisk = reports.filter(r => r.riskLevel === 'low').length;

            document.getElementById('high-risk-count').textContent = highRisk;
            document.getElementById('medium-risk-count').textContent = mediumRisk;
            document.getElementById('low-risk-count').textContent = lowRisk;
            document.getElementById('completed-onboarding').textContent = completedOnboardings;

            // Populate grade filter
            const grades = [...new Set(reports.map(r => r.studentGrade))];
            const gradeFilter = document.getElementById('filter-grade');
            gradeFilter.innerHTML = '<option value="all">Todas as Turmas</option>';
            grades.forEach(grade => {
                const option = document.createElement('option');
                option.value = grade;
                option.textContent = grade;
                gradeFilter.appendChild(option);
            });
        }

        function renderReports(filteredReports = null) {
            const reportsToRender = filteredReports || reports;
            const tbody = document.getElementById('reports-tbody');
            
            if (reportsToRender.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: var(--text-muted);">
                            Nenhum relato encontrado com os filtros selecionados.
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = reportsToRender.map(report => `
                <tr>
                    <td>${report.date}</td>
                    <td>${report.studentName}</td>
                    <td>${report.studentGrade}</td>
                    <td>${getReasonLabel(report.contactReason)}</td>
                    <td><span class="badge ${report.riskLevel}">${getRiskLabel(report.riskLevel)}</span></td>
                    <td>
                        <select onchange="updateReportStatus(${report.id}, this.value)" style="padding: 5px; border-radius: 5px; background: var(--bg-main); color: var(--text-primary); border: 1px solid var(--bg-card-hover);">
                            <option value="pending" ${report.status === 'pending' ? 'selected' : ''}>Pendente</option>
                            <option value="in-progress" ${report.status === 'in-progress' ? 'selected' : ''}>Em Acompanhamento</option>
                            <option value="closed" ${report.status === 'closed' ? 'selected' : ''}>Fechado</option>
                        </select>
                    </td>
                    <td>
                        <button onclick="viewReportDetails(${report.id})" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.85rem;">Ver Detalhes</button>
                    </td>
                </tr>
            `).join('');
        }

        function getReasonLabel(reason) {
            const labels = {
                'victim': 'V√≠tima',
                'aggressor': 'Agressor',
                'witness': 'Testemunha',
                'other': 'Outro'
            };
            return labels[reason] || reason;
        }

        function getRiskLabel(level) {
            const labels = {
                'high': 'Alto',
                'medium': 'M√©dio',
                'low': 'Baixo'
            };
            return labels[level] || level;
        }

        function filterReports() {
            const gradeFilter = document.getElementById('filter-grade').value;
            const riskFilter = document.getElementById('filter-risk').value;
            const statusFilter = document.getElementById('filter-status').value;

            let filtered = reports;

            if (gradeFilter !== 'all') {
                filtered = filtered.filter(r => r.studentGrade === gradeFilter);
            }

            if (riskFilter !== 'all') {
                filtered = filtered.filter(r => r.riskLevel === riskFilter);
            }

            if (statusFilter !== 'all') {
                filtered = filtered.filter(r => r.status === statusFilter);
            }

            renderReports(filtered);
        }

        function updateReportStatus(reportId, newStatus) {
            const report = reports.find(r => r.id === reportId);
            if (report) {
                report.status = newStatus;
                updateAdminStats();
            }
        }

        function viewReportDetails(reportId) {
            const report = reports.find(r => r.id === reportId);
            if (!report) return;

            const details = `
üìã DETALHES DO RELATO

üìÖ Data: ${report.date}
üë§ Respons√°vel: ${report.parentName}
üìû Telefone: ${report.parentPhone}
üìß E-mail: ${report.parentEmail}

üë®‚Äçüéì Aluno(a): ${report.studentName}
üè´ Turma: ${report.studentGrade}

üéØ Motivo: ${getReasonLabel(report.contactReason)}
üìç Local: ${report.incidentLocation}
üïê Quando: ${report.incidentWhen}

üí≠ Relato:
${report.incidentDetails}

üòü N√≠vel Emocional: ${report.emotionScale}/10
üÜò Risco: ${getRiskLabel(report.riskLevel).toUpperCase()}
üß† Apoio Psicol√≥gico: ${report.psychologicalSupport === 'yes' ? 'Sim' : report.psychologicalSupport === 'no' ? 'N√£o' : 'Talvez'}
            `;

            alert(details);
        }

        function loadSampleData() {
            // Sample data for demonstration
            completedOnboardings = 12;
            
            reports = [
                {
                    id: 1,
                    date: '01/10/2025',
                    parentName: 'Maria Silva',
                    parentPhone: '(11) 98765-4321',
                    parentEmail: 'maria@email.com',
                    studentName: 'Jo√£o Silva',
                    studentGrade: '7¬∫ Ano B',
                    contactReason: 'victim',
                    incidentLocation: 'playground',
                    incidentWhen: 'Esta semana',
                    incidentDetails: 'Meu filho relatou que est√° sendo exclu√≠do do grupo durante o recreio.',
                    emotionScale: 8,
                    psychologicalSupport: 'yes',
                    riskLevel: 'high',
                    status: 'pending'
                },
                {
                    id: 2,
                    date: '02/10/2025',
                    parentName: 'Carlos Oliveira',
                    parentPhone: '(11) 91234-5678',
                    parentEmail: 'carlos@email.com',
                    studentName: 'Ana Oliveira',
                    studentGrade: '8¬∫ Ano A',
                    contactReason: 'witness',
                    incidentLocation: 'corridor',
                    incidentWhen: 'M√™s passado',
                    incidentDetails: 'Minha filha viu colegas fazendo coment√°rios maldosos sobre outra aluna.',
                    emotionScale: 5,
                    psychologicalSupport: 'maybe',
                    riskLevel: 'medium',
                    status: 'in-progress'
                },
                {
                    id: 3,
                    date: '03/10/2025',
                    parentName: 'Patricia Santos',
                    parentPhone: '(11) 99876-5432',
                    parentEmail: 'patricia@email.com',
                    studentName: 'Pedro Santos',
                    studentGrade: '6¬∫ Ano C',
                    contactReason: 'victim',
                    incidentLocation: 'online',
                    incidentWhen: 'Ontem',
                    incidentDetails: 'Meu filho est√° recebendo mensagens ofensivas em grupo de WhatsApp da turma.',
                    emotionScale: 9,
                    psychologicalSupport: 'yes',
                    riskLevel: 'high',
                    status: 'pending'
                }
            ];
        }
    </script>
</body>
</html>
